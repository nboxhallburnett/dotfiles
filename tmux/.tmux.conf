
#   ------------------------   #
#           BINDINGS           #
#   ------------------------   #

# Make sure we are running from the default tmux bindings
source-file ~/Git/dotfiles/tmux/.tmux.reset.conf

# Enable Truecolor support
set        -g       default-terminal    "tmux-256color"
set-option -ga      terminal-overrides  ",xterm-256color:Tc"

# get rid of delay reading command characters while tmux waits for escape sequence
set   -s   escape-time      1

# start numbering from 0 instead of 1
set   -g   base-index       0
setw  -g   pane-base-index  0

# set scrollback history to 100K lines
set   -g   history-limit    100000

# change default prefix (C-b) to C-space
unbind     C-space
set   -g   prefix   C-space
bind       C-space  send-prefix

# bind C-a to last active window
bind-key   C-a      last-window

# reload ~/.tmux.conf using prefix r
bind       r        source-file ~/.tmux.conf \; display "tmux reloaded"

# change split prefixes (horizontal: C-space /) (vertical: C-space -)
bind       /        split-window -h
bind       -        split-window -v

# Change the default working dir for new panes to the wokring dir of the selected pane
bind  -r   >        attach       -c "#{pane_current_path}"

# make current window the 1st window
bind       T        swap-window -t 1

# ----------
# NAVIGATION
# ----------

# Enable mouse support
set   -g   mouse         on
bind  -n   WheelUpPane   if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind  -n   WheelDownPane select-pane -t= \; send-keys -M

# Switch panes using Shift-arrow without prefix
bind  -n   S-Left        select-pane  -L
bind  -n   S-Right       select-pane  -R
bind  -n   S-Up          select-pane  -U
bind  -n   S-Down        select-pane  -D

# Resize panes using bind-shift-arrow
bind  -r   S-Left        resize-pane  -L  2
bind  -r   S-Right       resize-pane  -R  2
bind  -r   S-Up          resize-pane  -U  2
bind  -r   S-Down        resize-pane  -D  2

# ----------
# VI
# ----------

# Enable vi support
setw     -g   mode-keys    vi
set      -g   status-keys  vi

# use vi scrolling 'j' and 'k' to scroll half pages up/down
bind-key -t   vi-copy      j       halfpage-down
bind-key -t   vi-copy      k       halfpage-up

# setup 'v' to begin selection as in vim
bind-key -t   vi-copy      v       begin-selection
bind-key -t   vi-copy      y       copy-pipe "reattach-to-user-namespace pbcopy"

# update default binding of `Enter` to also use copy-pipe (os x)
unbind   -t   vi-copy      Enter
bind-key -t   vi-copy      Enter   copy-pipe "reattach-to-user-namespace pbcopy"

#   ------------------------------   #
#           DESIGN CHANGES           #
#   ------------------------------   #

# ----------
# PANES
# ----------

set  -g  pane-border-fg         black
set  -g  pane-active-border-fg  brightred

# ----------
# STATUS BAR
# ----------

# set  -g  status-utf8            on
set  -g  status-justify         left
set  -g  status-bg              default
set  -g  status-fg              colour12
set  -g  status-interval        1

# ----------
# MESSAGES
# ----------

set  -g  message-fg             black
set  -g  message-bg             yellow
set  -g  message-command-fg     blue
set  -g  message-command-bg     black

# ----------
# WINDOW
# ----------

setw -g  mode-bg                       colour6
setw -g  mode-fg                       colour0

setw -g  window-status-format          " #F#I:#W#F "
setw -g  window-status-current-format  " #F#I:#W#F "
setw -g  window-status-format          "#[fg=magenta]#[bg=black] #I #[bg=cyan]#[fg=colour8] #W "
setw -g  window-status-current-format  "#[bg=brightmagenta]#[fg=colour8] #I #[fg=colour8]#[bg=colour14] #W "
setw -g  window-status-current-bg      colour0
setw -g  window-status-current-fg      colour11
setw -g  window-status-current-attr    dim
setw -g  window-status-bg              green
setw -g  window-status-fg              black
setw -g  window-status-attr            reverse

# ----------
# SHHHH
# ----------

set-option        -g  visual-activity  off
set-option        -g  visual-bell      off
set-option        -g  visual-silence   off
set-window-option -g  monitor-activity off
set-option        -g  monitor-silence  0
set-option        -g  bell-action      none
set-option        -g  allow-rename     off

# ----------
# MODES
# ----------

setw -g  clock-mode-colour      colour135
setw -g  mode-attr              bold
setw -g  mode-fg                colour196
setw -g  mode-bg                colour238

# ----------
# PANES
# ----------

set  -g  pane-border-bg         colour235
set  -g  pane-border-fg         colour238
set  -g  pane-active-border-bg  colour236
set  -g  pane-active-border-fg  colour51

# ----------
# STATUS BAR
# ----------

set  -g  status-position               bottom
# set  -g  status-justify                centre
set  -g  status-bg                     colour234
set  -g  status-fg                     colour137
set  -g  status-attr                   dim
# Powerline font characters - https://github.com/powerline/fonts
set  -g  status-left                   '#[bold]#{prefix_highlight}#[fg=colour233,bg=colour245,bold] #S #[fg=colour245,bg=colour243,nobold]#[fg=colour233,bg=colour243,bold] #(whoami) #[fg=colour243,bg=colour241,nobold]#[fg=colour233,bg=colour241,bold] #I:#P #[fg=colour241,bg=colour234,nobold]  '
set  -g  status-right                  '#[fg=colour241,bg=colour234,nobold]#[fg=colour233,bg=colour241,bold] #(echo  `currentlyPlaying`) #[fg=colour243,bg=colour241,nobold]#[fg=colour233,bg=colour243,bold] %d/%m/%y #[fg=colour245,bg=colour243,nobold]#[fg=colour233,bg=colour245,bold] %l:%M:%S %p '
set  -g  status-right-length           150
set  -g  status-left-length            50

setw -g  window-status-current-fg      colour81
setw -g  window-status-current-bg      colour238
setw -g  window-status-current-attr    bold
setw -g  window-status-current-format  '#[fg=colour234,bg=colour238,nobold] #[fg=colour81,bg=colour238,bold]#I#[fg=colour250]:#[fg=colour255]#W#[fg=colour50]#F #[fg=colour234,bg=colour238,nobold]'

setw -g  window-status-fg              colour138
setw -g  window-status-bg              colour235
setw -g  window-status-attr            none
setw -g  window-status-format          ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

setw -g  window-status-bell-attr       bold
setw -g  window-status-bell-fg         colour255
setw -g  window-status-bell-bg         colour1

# ----------
# MESSAGES
# ----------

set  -g  message-attr           bold
set  -g  message-fg             colour232
set  -g  message-bg             colour166

#   -------------------------   #
#      TMUX PLUGIN MANAGER      #
#   -------------------------   #

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

set -g @sidebar-tree-command 'tree -L 2 -C -I ".git|node_modules|web-built"'

set -g @prefix_highlight_fg 'colour233' # default is 'colour231'
set -g @prefix_highlight_bg 'colour245'  # default is 'colour04'

# Other examples:
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
