#   -----------------------------   #
#       SET UP TERMINAL PROMPT      #
#   -----------------------------   #

# Shorten the working directory to /base/.../current_dir if the length is too long
export MYPS='$(echo -n "${PWD/#$HOME/~}" | awk -F "/" '"'"'{
if (length($0) > 35) { if (NF>4) print $1 "/" $2 "/.../" $(NF-1) "/" $NF;
else if (NF>3) print $1 "/" $2 "/.../" $NF;
else print $1 "/.../" $NF; }
else print $0;}'"'"')'

# params: foreground, background, bold
function colour {
	echo "\033[$3;38;5;$1;48;5;$2m"
}

# PS1="$LIGHTGRAY${fill} \d ─ \t ──$NC\n"
# Display prompt that matches tmux style if currently in tmux
if [ -n "$TMUX" ]; then
	# PS1="\e[1;30;42m \h \e[32;43m\e[30;43m $(eval "echo \${MYPS}") \e[33;40m$NC\$(__git_ps1)\n> " # Green  Yellow 
	# PS1="\n\e[1;30;47m \h \e[37;100m\e[1;37;100m $(eval "echo \${MYPS}") \e[90;40m$NC\$(__git_ps1)\n> " # Light grey  Dark grey 
	PS1="\n$(colour 233 253 1) \h $(colour 253 247 0)$(colour 233 247 1) $(eval "echo \${MYPS}") $(colour 247 243 0)$NC\$(__git_ps1 '$(colour 233 243 1)  %s $(colour 243 0 0)$(colour 0 243 1)$NC')\n> " # White  Light grey  Dark grey  clear
else
	# PS1="$CYAN\u$NC@$GREEN\h$NC: $YELLOW$(eval "echo \${MYPS}")$NC\$(__git_ps1)\n> "
	PS1="$GREEN\h$NC: $YELLOW$(eval "echo \${MYPS}")$NC\$(__git_ps1)\n> "
fi
PS1='$(printf "%$((COLUMNS-1))s\r")'$PS1
PS2='» '

function prompt_command {

	# create a $fill of all screen width minus the time string and a space:
	let fillsize=${COLUMNS}-25
	fill=""
	while [ "$fillsize" -gt "0" ]
	do
		fill="─${fill}" # fill with underscores to work on
		let fillsize=${fillsize}-1
	done

	. ~/.bash_prompt

}
PROMPT_COMMAND=prompt_command
